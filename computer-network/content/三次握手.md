因为TCP是面向链接的，所以TCP在使用钱必须先建立连接，而建立连接是通过三次挥手来进行的。

![](https://tva1.sinaimg.cn/large/008eGmZEgy1go9ybdei2tj310g0u0gpf.jpg)

- 一开始，客户端和服务端都处于CLOSED状态，先是服务端主动监听某个端口，处于LISTEN状态
- 客户端随即初始化一个序列号clietn_isn，将此序号置于TCP首部的序号字段中，同时把SYN标志位置为1，表示SYN报文。接着把第一个SYN报文发送给服务端，表示向服务端发起连接，该报文不包含应用层数据，之后客户端处于SYN-SENT状态
- 服务端收到客户端的SYN报文后，首先服务端也随机初始化自己的序号server_isn，将此序号填入 TCP首部的序号字段中，其次把TCP首部的确认应答号字段填入client_isn + 1 , 接着把SYN和 ACK标志位置为1 。最后把该报文发给客户端，该报文也不包含应用层数据，之后服务端处于 SYN-RCVD 状态
- 客户端收到服务端报文后，还要向服务端回应最后一个应答报文，首先该应答报文 TCP 首部 ACK 标志位置为1，其次确认应答号字段填入server_isn + 1，最后把报文发送给服务端，这次报文可以携带客户到服务器的数据，之后客户端处于ESTABLISHED状态
- 服务器收到客户端的应答报文后，也进入ESTABLISHED状态

