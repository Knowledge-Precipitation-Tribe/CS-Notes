redis可以主从同步也可以从从同步。首次同步时，主节点会做一次bgsave，并同时将后续的修改操作记录到内存buffer，待完成后将RDB文件同步到从节点中做全量复制，从节点加载完成后通知主节点将期间修改的操作记录同步到从节点中，这样就完成了初步的同步过程，后续的数据操作通过AOF进行同步即可。

启动一台slaver的时候，他会发送一个psync命令给master，如果是这个slave第一次连接到master，他会触发一个全量复制。master 就会启动一个线程，生成 RDB 快照，还会把新的写请求都缓存在内存中，RDB 文件生成后，master 会将这个 RDB 发送给 slave 的，slave 拿到之后做的第一件事情就是写进本地的磁盘，然后加载进内存，然后 master 会把内存里面缓存的那些新命令都发给 slave。

